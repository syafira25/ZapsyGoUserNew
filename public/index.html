<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ZapsyGo</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Remix Icon & FontAwesome -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- Swiper -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" /> -->
    <link rel="stylesheet" href="style2.css" />
    <link rel="stylesheet" href="styles.css" />

    <!-- Preloader Style -->
    <style>
      #preloader {
        position: fixed;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background-color: #ffffff;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .spinner {
        width: 60px;
        height: 60px;
        border: 8px solid #eee;
        border-top: 8px solid #2560a3;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container">
        <a class="navbar-brand fw-bold" href="#">ZapsyGo</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
          <ul class="navbar-nav gap-2 m-auto">
            <li class="nav-item"><a class="nav-link" href="index.html">BERANDA</a></li>
            <li class="nav-item"><a class="nav-link" href="about.html">TENTANG KAMI</a></li>
            <li class="nav-item"><a class="nav-link" href="itinerary.html">ITINERARY</a></li>
            <li class="nav-item"><a class="nav-link" href="destinasi.html">DESTINASI</a></li>
          </ul>
          <ul class="navbar-nav gap-2">
            <!-- Tombol Masuk (untuk user belum login) -->
            <li class="nav-item" id="loginButton">
              <a class="btn fw-bold px-3" href="login.html">MASUK</a>
            </li>

            <!-- Dropdown Profil (hanya muncul jika sudah login) -->
            <li class="nav-item dropdown d-none" id="profileDropdown">
              <a class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-user-circle fs-4"></i> <span>Profil</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" href="profile.html">Profil Saya</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-danger" href="logout.html">Logout </a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Header -->
    <header id="" class="text-white mt-custom mx-2 radius-lg">
      <div class="m-3 w-100 h-100 d-flex flex-column position-relative">
        <!-- header-image  -->
        <div class="position-absolute w-100 h-100 d-flex align-items-center p-5" style="left: 0">
          <div class="text-start container">
            <h1 class="display-4 fw-bold" style="max-width: 380px">Liburan seru di Batam mulai dari mana hari ini?</h1>
          </div>
        </div>
        <div class="d-flex align-items-center justify-content-center w-50">
          <div class="bg-white rounded5 shadow-lg p-4 mt-4 position-absolute search-box w-50" style="max-width: 1140px">
            <form id="searchForm" class="w-100">
              <div class="input-group mb-3">
                <span class="input-group-text bg-white border-end-0">
                  <i class="fas fa-search text-muted"></i>
                </span>
                <input type="text" id="searchInput" class="form-control border-start-0" placeholder="Cari destinasi..." required />
                <button class="btn" style="background-color: #2560a3; color: white" type="submit">Cari</button>
              </div>
            </form>

            <!-- Tempat hasil pencarian (opsional) -->
            <div id="searchResult" class="mt-3"></div>

            <div class="d-flex justify-content-center gap-4">
  <div class="text-center">
    <a href="#rekomendasi-hotel" class="text-decoration-none">
      <div class="icon-circle">
        <i class="fas fa-hotel text-primary"></i>
      </div>
      <small class="d-block mt-1 text-primary fw-bold">Hotel</small>
    </a>
  </div>
  <div class="text-center">
    <a href="#about" class="text-decoration-none">
      <div class="icon-circle">
        <i class="fas fa-map-marked-alt text-primary"></i>
      </div>
      <small class="d-block mt-1 text-primary fw-bold">Wisata</small>
    </a>
  </div>
</div>
                <small class="d-block mt-1 text-primary fw-bold">Wisata</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Destinasi Populer -->
<!-- Destinasi Populer Otomatis dari Backend -->
<section id="about" class="container mt-5 pt-5" style="margin-bottom: 4rem">
  <h2 class="text-left fw-bold mb-4" style="color: #2560a3">Destinasi Populer di Batam</h2>
  <div class="row g-4" id="populerDestinasiContainer">
    <!-- Kartu destinasi akan dimuat otomatis via JavaScript -->
  </div>
</section>

    <!-- Section Itinerary Home -->
    <section class="container mb-5">
      <div class="rounded-5 p-4 d-flex flex-column flex-md-row align-items-center justify-content-between gap-4" style="background-color: #2560a3">
        <!-- Gambar -->
        <div class="flex-shrink-0">
          <img src="assets/barelang.jpeg" alt=" class="img-fluid rounded-5" style="max-width: 600px" />
        </div>

        <!-- Teks -->
        <div class="text-white position-relative" style="z-index: 2">
          <h1 class="fw-bold display-5">Rencanakan liburanmu di Batam!</h1>
          <p class="fs-4 mb-4">Temukan itinerary 1 sampai 4 hari sesuai waktu liburanmu.</p>
          <a href="itinerary.html" class="btn btn-light fw-semibold px-4 py-2 fs-5" style="color: #2560a3">Lihat Itinerary</a>
        </div>
      </div>
    </section>

    <!-- Section 3 Rekomendasi -->
    <section id="rekomendasi-hotel" class="container rekomendasi__container" style="margin-bottom: 7rem">
      <h2 class="text-left fw-bold mb-4" style="color: #2560a3">Rekomendasi Penginapan di Batam</h2>
      <!-- Slider main container -->
      <div class="swiper w-100 overflow-auto">
        <!-- Additional required wrapper -->
        <div class="swiper-wrapper d-flex flex-row m-auto" style="gap: 2rem">
          <!-- Slides -->
          <div class="swiper-slide">
            <div class="client__card">
              <div class="client__content">
                <div class="client__rating">
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                </div>
                <img src="assets/aston.jpg" alt="client" />
              </div>
              <div class="client__details">
                <div class="text-center">
                  <h4>Hotel ASTON</h4>
                  <h5>Nagoya</h5>
                </div>
              </div>
            </div>
          </div>
          <div class="swiper-slide">
            <div class="client__card">
              <div class="client__content">
                <div class="client__rating">
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                </div>
                <img src="assets/aston.jpg" alt="client" />
              </div>
              <div class="client__details">
                <div class="text-center">
                  <h4>Hotel ASTON</h4>
                  <h5>Nagoya</h5>
                </div>
              </div>
            </div>
          </div>
          <div class="swiper-slide">
            <div class="client__card">
              <div class="client__content">
                <div class="client__rating">
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                  <span><i class="ri-star-fill"></i></span>
                </div>
                <img src="assets/aston.jpg" alt="client" />
              </div>
              <div class="client__details">
                <div class="text-center">
                  <h4>Hotel ASTON</h4>
                  <h5>Nagoya</h5>
                </div>
              </div>
            </div>
          </div>
        </div>
            <!-- Preloader -->
    <div id="preloader">
      <div class="spinner"></div>
      </div>
    </section>

    <!-- Footer -->
    <footer id="contact" class="py-5">
      <div class="container">
        <div class="row gy-4">
          <!-- Kolom 1: Logo dan Deskripsi -->
          <div class="col-md-4">
            <div class="footer__logo mb-2">
              <a href="#" class="logo fs-4 fw-bold text-decoration-none" style="color: #2560a3">ZapsyGo</a>
            </div>
            <p style="color: #2560a3">
              Explore the world with ease and excitement through our comprehensive travel platform. Your journey begins here, where seamless planning meets unforgettable experiences.
            </p>
            <ul class="list-inline mt-3 footer__socials">
              <li class="list-inline-item">
                <a href="#"><i class="ri-facebook-fill fs-5 text-light"></i></a>
              </li>
              <li class="list-inline-item">
                <a href="#"><i class="ri-instagram-line fs-5 text-light"></i></a>
              </li>
              <li class="list-inline-item">
                <a href="#"><i class="ri-youtube-line fs-5 text-light"></i></a>
              </li>
            </ul>
          </div>

          <!-- Kolom 2: Akses Cepat -->
          <div class="col-md-4" style="color: #2560a3">
            <h5 class="mb-3 fw-bold">Akses Cepat</h5>
            <ul class="list-unstyled footer__links">
              <li><a href="index.html" class="text-decoration-none text-dark">Beranda</a></li>
              <li><a href="#" class="text-decoration-none text-dark">Destinasi</a></li>
              <li><a href="#" class="text-decoration-none text-dark">Hotel</a></li>
              <li><a href="#" class="text-decoration-none text-dark">Tentang Kami</a></li>
            </ul>
          </div>

          <!-- Kolom 3: Kontak -->
          <div class="col-md-4" style="color: #2560a3">
            <h5 class="mb-3 fw-bold">Kontak Kami</h5>
            <ul class="list-unstyled footer__links">
              <li class="mb-2">
                <a href="#" class="text-decoration-none text-dark"> <i class="ri-phone-fill me-2"></i> +62918278129 </a>
              </li>
              <li class="mb-2">
                <a href="#" class="text-decoration-none text-dark"> <i class="ri-record-mail-line me-2"></i> info@zapsygo </a>
              </li>
              <li>
                <a href="#" class="text-decoration-none text-dark"> <i class="ri-map-pin-2-fill me-2"></i> Batam, Indonesia </a>
              </li>
            </ul>
          </div>
        </div>

        <!-- Footer bar -->
        <div class="text-center mt-4 footer__bar text-muted small">Copyright Â© 2025 ZapsyGo. All rights reserved.</div>
      </div>
    </footer>

<script>
      // Preloader hide saat halaman selesai load
      window.addEventListener("load", function () {
        const preloader = document.getElementById("preloader");
        if (preloader) {
          preloader.style.opacity = "0";
          preloader.style.transition = "opacity 0.5s ease";
          setTimeout(() => {
            preloader.style.display = "none";
          }, 500);
        }
      });
      
  // Aktifkan nav-link berdasarkan URL path
  window.addEventListener("DOMContentLoaded", () => {
    const currentPath = window.location.pathname.split("/").pop();

    document.querySelectorAll(".nav-link").forEach((link) => {
      const linkHref = link.getAttribute("href").split("/").pop();
      if (linkHref.startsWith("#")) {
        if (window.location.hash === linkHref) {
          link.classList.add("active");
        }
      } else {
        if (currentPath === "" && linkHref === "index.html") {
          link.classList.add("active");
        } else if (currentPath === linkHref) {
          link.classList.add("active");
        }
      }
    });

    // Ambil status login dari localStorage
    const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";
    const username = localStorage.getItem("username") || "Profil";

    const loginBtn = document.getElementById("loginButton");
    const profileDropdown = document.getElementById("profileDropdown");

    if (isLoggedIn) {
      loginBtn?.classList.add("d-none");
      profileDropdown?.classList.remove("d-none");

     // ðŸ”½ Tambahan: Ambil foto profil dari backend
fetch(`http://localhost:5000/api/profile?username=${username}`)
  .then(res => res.json())
  .then(data => {
    const dropdownLink = profileDropdown.querySelector("a.nav-link");
    let photoURL = data.photo;

    // âœ… Jika photoURL masih berupa path lokal atau nama file, ubah jadi URL yang bisa diakses
    if (photoURL && !photoURL.startsWith("http")) {
      photoURL = `http://localhost:5000/uploads/${photoURL.split('\\').pop().split('/').pop()}`;
    }

    if (photoURL) {
      const icon = dropdownLink.querySelector("i");
      if (icon) icon.remove();

      dropdownLink.innerHTML = `
        <img src="${photoURL}" alt="Foto" class="rounded-circle me-2" style="width: 32px; height: 32px; object-fit: cover;">
        <span>${username}</span>
      `;
    } else {
      dropdownLink.innerHTML = `
        <i class="fas fa-user-circle fs-4"></i> <span>${username}</span>
      `;
    }
  })
  .catch(err => {
    console.error("Gagal memuat foto profil:", err);
  });
    } else {
      loginBtn?.classList.remove("d-none");
      profileDropdown?.classList.add("d-none");
    }
  }); 

  // Fungsi Pencarian Destinasi Real-Time
document.getElementById("searchInput").addEventListener("input", function () {
  const keyword = this.value.toLowerCase();
  const cards = document.querySelectorAll(".destination-item");
  let found = false;

  cards.forEach((card) => {
    const name = card.dataset.name.toLowerCase();
    if (name.includes(keyword)) {
      card.style.display = "block";
      found = true;
    } else {
      card.style.display = "none";
    }
  });

  const resultBox = document.getElementById("searchResult");
  if (!found && keyword !== "") {
    resultBox.innerHTML = `<div class="alert alert-warning mt-2">Destinasi tidak ditemukan.</div>`;
  } else {
    resultBox.innerHTML = "";
  }
});
 // Fungsi untuk memuat data destinasi populer ke homepage
  fetch("http://localhost:5000/api/destinasi?populer=true")
    .then(res => res.json())
    .then(data => {
      const container = document.getElementById("populerDestinasiContainer");
      container.innerHTML = ""; // Kosongkan dulu kontainer

      data.forEach(item => {
        const card = document.createElement("div");
        card.className = "col-md-4 destination-item";
        card.setAttribute("data-name", item.nama.toLowerCase());

        // Pastikan foto memiliki URL lengkap (jika dari backend lokal)
        let fotoPath = item.foto || "";
        if (!fotoPath.startsWith("http")) {
          fotoPath = fotoPath.replace(/^\/?uploads[\\/]/, ''); // hapus prefix uploads/
          fotoPath = `http://localhost:5000/uploads/${fotoPath}`;
        }

        // Isi kartu destinasi
card.innerHTML = `
  <div class="card populer-hover shadow-sm border-0 h-100">
    <img src="${fotoPath}" class="card-img-top shadow-lg overflow-hidden" alt="${item.nama}" />
    <div class="card-body text-center">
      <h5 class="card-title">${item.nama}</h5>
      <p class="card-text">${item.lokasi}</p>
    </div>
  </div>`;
        container.appendChild(card); // Tambahkan ke halaman
      });
    })
    .catch(err => {
      console.error("Gagal memuat destinasi populer:", err);
      const container = document.getElementById("populerDestinasiContainer");
      container.innerHTML = `
        <div class="col-12">
          <div class="alert alert-danger text-center">Gagal memuat destinasi populer.</div>
        </div>`;
    });
</script>


  </body>
</html>